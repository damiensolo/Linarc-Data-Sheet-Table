import React from 'react';
import { motion } from 'framer-motion';

// --- Type Definitions ---
interface BookmarkItem {
    categoryKey: string;
    itemKey: string;
    label: string;
    description: string;
    icon: React.ReactNode;
    navIcon: React.ReactNode;
}

interface BookmarksMenuProps {
    bookmarks: BookmarkItem[];
    onSelect: (categoryKey: string, subcategoryKey: string) => void;
    onToggleBookmark: (categoryKey: string, itemKey: string) => void;
    position?: 'bottom' | 'right';
}

// Bookmark Icon Component
const BookmarkIcon: React.FC<{ filled: boolean; className?: string }> = ({ filled, className = '' }) => (
    <svg 
        xmlns="http://www.w3.org/2000/svg" 
        width="16" 
        height="16" 
        viewBox="0 0 24 24" 
        fill={filled ? "currentColor" : "none"} 
        stroke="currentColor" 
        strokeWidth="2" 
        strokeLinecap="round" 
        strokeLinejoin="round"
        className={className}
    >
        <path d="M19 21l-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z"/>
    </svg>
);

const BookmarksMenu: React.FC<BookmarksMenuProps> = ({ bookmarks, onSelect, onToggleBookmark, position = 'bottom' }) => {
    const isRightPosition = position === 'right';
    
    const emptyMenuClasses = isRightPosition
        ? "absolute left-full top-0 ml-2 bg-white rounded-xl shadow-2xl p-6 md:p-8 z-[100] origin-top-left w-[calc(100vw-2rem)] md:w-auto md:min-w-[400px]"
        : "absolute top-full left-0 bg-white rounded-xl shadow-2xl p-6 md:p-8 z-[100] origin-top-left w-[calc(100vw-2rem)] md:w-auto md:min-w-[400px]";
    
    const menuClasses = isRightPosition
        ? "absolute left-full top-0 ml-2 bg-white rounded-xl shadow-2xl p-4 md:p-6 lg:p-8 z-[100] origin-top-left w-[calc(100vw-2rem)] md:w-auto md:min-w-[500px]"
        : "absolute top-full left-0 bg-white rounded-xl shadow-2xl p-4 md:p-6 lg:p-8 z-[100] origin-top-left w-[calc(100vw-2rem)] md:w-auto md:min-w-[500px]";
    
    const animationProps = isRightPosition
        ? {
            initial: { opacity: 0, x: -10, scale: 0.95 },
            animate: { opacity: 1, x: 0, scale: 1 },
            exit: { opacity: 0, x: -10, scale: 0.95 }
        }
        : {
            initial: { opacity: 0, y: 10, scale: 0.95 },
            animate: { opacity: 1, y: 0, scale: 1 },
            exit: { opacity: 0, y: 10, scale: 0.95 }
        };

    if (bookmarks.length === 0) {
        return (
            <motion.div
                {...animationProps}
                transition={{ duration: 0.2, ease: 'easeOut' }}
                className={emptyMenuClasses}
            >
                <div className="text-center py-8">
                    <BookmarkIcon filled={false} className="w-12 h-12 text-gray-300 mx-auto mb-4" />
                    <p className="text-gray-500 text-sm">No bookmarks yet</p>
                    <p className="text-gray-400 text-xs mt-2">Bookmark items in the menu to add them here</p>
                </div>
            </motion.div>
        );
    }

    return (
        <motion.div
            {...animationProps}
            transition={{ duration: 0.2, ease: 'easeOut' }}
            className={menuClasses}
        >
            <div className="mb-4 pb-4 border-b border-gray-100">
                <h3 className="text-lg font-semibold text-gray-800">Bookmarks</h3>
                <p className="text-xs text-gray-500 mt-1">Your frequently used tools</p>
            </div>
            <div className="grid grid-cols-1 md:grid-cols-2 gap-3 text-black">
                {bookmarks.map((item) => (
                    <a
                        key={`${item.categoryKey}:${item.itemKey}`}
                        href="#"
                        onClick={(e) => {
                            e.preventDefault();
                            onSelect(item.categoryKey, item.itemKey);
                        }}
                        className="flex items-start gap-3 p-3 rounded-lg hover:bg-gray-50 transition-colors duration-150 group relative"
                    >
                        {item.icon}
                        <div className="flex-1 min-w-0">
                            <div className="flex items-center justify-between gap-2">
                                <h5 className="font-semibold text-gray-800 text-sm group-hover:text-blue-600 truncate">
                                    {item.label}
                                </h5>
                                <button
                                    onClick={(e) => {
                                        e.preventDefault();
                                        e.stopPropagation();
                                        onToggleBookmark(item.categoryKey, item.itemKey);
                                    }}
                                    className="opacity-100 p-1 hover:bg-gray-100 rounded transition-colors"
                                    aria-label="Remove bookmark"
                                >
                                    <BookmarkIcon 
                                        filled={true} 
                                        className="w-4 h-4 text-yellow-500"
                                    />
                                </button>
                            </div>
                            <p className="text-gray-500 text-xs w-auto mt-0.5 line-clamp-2">
                                {item.description}
                            </p>
                        </div>
                    </a>
                ))}
            </div>
        </motion.div>
    );
};

export default BookmarksMenu;
